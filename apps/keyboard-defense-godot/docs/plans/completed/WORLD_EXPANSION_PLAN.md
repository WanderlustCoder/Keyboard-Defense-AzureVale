# World Expansion Plan: The Greater Realm of Keystonia

**Created:** 2026-01-08

This document outlines the vision and implementation plan for expanding the game world to feel like a much larger, richer kingdom with diverse regions, hidden secrets, and meaningful exploration.

## Current State

### Existing Content
- **4 Core Biomes**: Evergrove (forest), Stonepass (mountain), Mistfen (swamp), Sunfields (plains)
- **3 Elemental Realms**: Fire Realm, Ice Realm, Nature Realm
- **68 Map Nodes**: Skill-based progression locations
- **21 POIs**: Points of interest for exploration events
- **16x10 Exploration Grid**: Open world tile system

### Gaps
- World feels disconnected - biomes exist as isolated game elements
- No overarching geography or lore tying regions together
- Limited sense of scale or journey
- Few secrets or hidden discoveries
- No world map visualization

---

## Vision: The Greater Realm of Keystonia

### World Scale Hierarchy

```
┌─────────────────────────────────────────────────────────────────────┐
│                        THE REALM OF KEYSTONIA                        │
├─────────────────────────────────────────────────────────────────────┤
│                                                                      │
│   ┌─────────────┐    ┌─────────────┐    ┌─────────────┐             │
│   │  VERDANT    │    │  CENTRAL    │    │   OUTER     │             │
│   │  HEARTLAND  │    │  KINGDOM    │    │  FRONTIER   │             │
│   │ (Starting)  │────│  (Mid-game) │────│  (End-game) │             │
│   └─────────────┘    └─────────────┘    └─────────────┘             │
│         │                  │                  │                      │
│    ┌────┴────┐        ┌────┴────┐        ┌────┴────┐                │
│    │ Regions │        │ Regions │        │ Regions │                │
│    └────┬────┘        └────┬────┘        └────┬────┘                │
│         │                  │                  │                      │
│    ┌────┴────┐        ┌────┴────┐        ┌────┴────┐                │
│    │  Zones  │        │  Zones  │        │  Zones  │                │
│    └────┬────┘        └────┬────┘        └────┬────┘                │
│         │                  │                  │                      │
│    ┌────┴────┐        ┌────┴────┐        ┌────┴────┐                │
│    │  POIs   │        │  POIs   │        │  POIs   │                │
│    └─────────┘        └─────────┘        └─────────┘                │
│                                                                      │
└─────────────────────────────────────────────────────────────────────┘
```

---

## The Three Lands of Keystonia

### 1. The Verdant Heartland (Starting Region)

The peaceful lands surrounding Castle Keystonia where new typists begin their journey.

#### Regions

| Region | Theme | Biome Base | Key Features |
|--------|-------|------------|--------------|
| **Evergrove Forest** | Ancient woods | Forest | Starting area, Elder Lyra's domain |
| **Sunfields Plains** | Golden farmlands | Plains | Open meadows, simple words |
| **Whisperdale Valley** | Gentle hills | Mixed | Tutorial zones, quiet glades |
| **Millbrook Township** | Rustic village | Settlement | NPCs, shops, training grounds |

#### Zones per Region (4-6 each)

**Evergrove Forest:**
- Forest Gate (entry)
- Whisper Grove
- Elder's Glade
- Mossy Hollow
- Ancient Oak Circle
- Grove Guardian's Den (boss)

**Sunfields Plains:**
- Farmer's Road
- Golden Meadow
- Windmill Heights
- Harvest Square
- Champion's Field
- Sunlord Arena (boss)

#### Exploration Grid: 24x16 tiles
- Mix of plains (40%), forest (35%), settlement (15%), water (10%)
- 15-20 discoverable POIs
- Day 1-8 content

---

### 2. The Central Kingdom (Mid-Game Region)

The heart of Keystonia with the great citadel, mountain passes, and mystical swamps.

#### Regions

| Region | Theme | Biome Base | Key Features |
|--------|-------|------------|--------------|
| **Stonepass Mountains** | Dwarven peaks | Mountain | Mines, forges, vertical zones |
| **Mistfen Marshes** | Mysterious swamps | Swamp | Hidden paths, fog mechanics |
| **The Citadel** | Royal fortress | Urban | Central hub, advanced training |
| **Twilight Woods** | Shadow forest | Dark forest | Day/night affects difficulty |
| **Crystalline Caverns** | Underground | Cave | Numbers/symbols focus |

#### Zones per Region (6-8 each)

**Stonepass Mountains:**
- Stone Gate Pass
- Miner's Descent
- Dwarven Forge
- Crystal Mine
- Summit Trail
- Frost Peak
- Mountain Cairn
- Citadel Warden's Tower (boss)

**Mistfen Marshes:**
- Rotting Dock
- Weeping Willows
- Hermit's Crossing
- Sunken Ruins
- Reed Maze
- Forgotten Graveyard
- Fen Seer's Domain (boss)

**The Citadel:**
- Outer Ward
- Training Grounds
- Scribe's Hall
- Grand Library
- Royal Court
- Capital Tower
- Eternal Scribe's Archive (boss)

#### Exploration Grid: 32x20 tiles
- Mountain (30%), swamp (25%), forest (20%), urban (15%), cave (10%)
- 30-40 discoverable POIs
- Day 9-16 content

---

### 3. The Outer Frontier (End-Game Region)

The dangerous borderlands where the Typhos Horde threatens and elemental chaos reigns.

#### Regions

| Region | Theme | Biome Base | Key Features |
|--------|-------|------------|--------------|
| **Fire Realm** | Volcanic lands | Volcanic | Speed-focused challenges |
| **Ice Realm** | Frozen wastes | Tundra | Precision challenges |
| **Nature Realm** | Primal wilds | Ancient forest | Balance challenges |
| **The Void Rift** | Corruption zone | Void | Final boss area |
| **Legendary Trials** | Ultimate tests | Mixed | Post-game content |
| **The Shattered Isles** | Floating islands | Sky | Secret endgame zone |

#### Zones per Region (6-10 each)

**Fire Realm:**
- Ember Path
- Lava Fields
- Volcanic Forge
- Obsidian Spire
- Inferno Core
- Flame Tyrant's Throne (boss)

**Ice Realm:**
- Frozen Approach
- Glacier Valley
- Crystal Ice Cave
- Blizzard Peak
- Frozen Citadel
- Glacier Heart
- Frost Empress Palace (boss)

**Nature Realm:**
- Living Grove
- Ancient Hollow
- Druid's Circle
- World Tree Roots
- Canopy Heights
- World Tree Summit
- Ancient Treant's Domain (boss)

**The Void Rift:**
- Corrupted Border
- Shadow Wastes
- Nightmare Valley
- Void Spire
- Tyrant's Approach
- Void Tyrant's Throne (final boss)

#### Exploration Grid: 40x24 tiles
- Volcanic (20%), tundra (20%), ancient forest (20%), void (15%), sky (10%), mixed (15%)
- 50+ discoverable POIs
- Day 17-25+ content

---

## World Map Visualization

### Overworld Map Structure

```
                          ┌─────────────────┐
                          │  THE SHATTERED  │
                          │     ISLES       │
                          │   (Post-game)   │
                          └────────┬────────┘
                                   │
    ┌──────────────┐      ┌───────┴───────┐      ┌──────────────┐
    │  ICE REALM   │──────│   VOID RIFT   │──────│  FIRE REALM  │
    │   Frozen     │      │   (Final)     │      │   Volcanic   │
    │   Wastes     │      └───────┬───────┘      │   Lands      │
    └──────┬───────┘              │              └──────┬───────┘
           │              ┌───────┴───────┐             │
           │              │ NATURE REALM  │             │
           │              │  Ancient      │             │
           │              │  Wilds        │             │
           │              └───────┬───────┘             │
           │                      │                     │
    ┌──────┴───────────────┬──────┴──────┬─────────────┴──────┐
    │                      │             │                     │
┌───┴────┐          ┌──────┴─────┐  ┌────┴─────┐        ┌─────┴────┐
│STONEPASS│          │  CITADEL   │  │ TWILIGHT │        │ CRYSTAL  │
│MOUNTAINS│          │  (Hub)     │  │  WOODS   │        │ CAVERNS  │
└───┬────┘          └──────┬─────┘  └────┬─────┘        └─────┬────┘
    │                      │             │                     │
    └──────────────┬───────┴─────────────┴─────────────────────┘
                   │
    ┌──────────────┼──────────────┐
    │              │              │
┌───┴────┐   ┌─────┴─────┐  ┌────┴─────┐
│MISTFEN │   │ EVERGROVE │  │SUNFIELDS │
│MARSHES │   │  FOREST   │  │  PLAINS  │
└────────┘   └─────┬─────┘  └──────────┘
                   │
            ┌──────┴──────┐
            │   CASTLE    │
            │  KEYSTONIA  │
            │  (Start)    │
            └─────────────┘
```

### Map UI Features

1. **Region Unlock Visualization**
   - Fog of war over unvisited regions
   - Glowing borders on accessible regions
   - Boss icon markers for region bosses

2. **Progress Indicators**
   - Completion percentage per region
   - Star ratings for mastery
   - POI discovery counter

3. **Quick Travel System**
   - Unlocked waypoints at key locations
   - Travel requires typing a short word
   - Visual path animation between points

---

## New Biomes & Terrain Types

### Expanded Terrain Palette

| Terrain | Movement | Buildable | Found In |
|---------|----------|-----------|----------|
| Plains | Normal | Yes | Sunfields, Heartland |
| Forest | Normal | Yes | Evergrove, Nature Realm |
| Deep Forest | Slow | No | Ancient areas |
| Mountain | Blocked | No | Stonepass |
| Mountain Path | Slow | No | Stonepass |
| Swamp | Slow | No | Mistfen |
| Swamp Shallows | Slow | Yes | Mistfen edges |
| Water | Blocked | No | All |
| Bridge | Normal | No | River crossings |
| Lava | Blocked | No | Fire Realm |
| Cooled Lava | Slow | Yes | Fire Realm |
| Ice | Fast | Yes | Ice Realm |
| Frozen Lake | Fast | No | Ice Realm |
| Void | Blocked | No | Void Rift |
| Void Path | Slow | No | Void Rift |
| Sky Platform | Normal | Yes | Shattered Isles |
| Ancient Stone | Normal | Yes | Ruins, Citadel |
| Cave Floor | Normal | Yes | Underground |
| Crystal | Normal | No | Caverns |

### Environmental Hazards

| Hazard | Effect | Counter |
|--------|--------|---------|
| Volcanic Vents | Periodic damage | Timing-based movement |
| Blizzard Zones | Reduced visibility | Accuracy challenges |
| Poison Fog | Damage over time | Speed through zone |
| Void Corruption | Accuracy debuff | Cleanse at shrines |
| Quicksand | Movement trap | Type to escape |

---

## POI Expansion

### New POI Categories

#### Discovery POIs (One-time rewards)
- Ancient Relics (lore + gold)
- Hidden Caches (resources)
- Forgotten Shrines (permanent bonuses)
- Secret Passages (unlock shortcuts)

#### Recurring POIs (Repeatable events)
- Resource Nodes (wood, stone, food)
- Training Dummies (practice fights)
- Wandering Merchants (random shop)
- Challenge Stones (timed trials)

#### Story POIs (Campaign progression)
- Lore Monuments (world history)
- NPC Encounters (quests, dialogue)
- Boss Lairs (major battles)
- Cutscene Triggers (story beats)

### POI Count Targets

| Region | Current | Target | Types |
|--------|---------|--------|-------|
| Evergrove | 5 | 15 | Discovery, Resource, Story |
| Sunfields | 5 | 15 | Discovery, Resource, Training |
| Stonepass | 5 | 20 | Discovery, Resource, Mining |
| Mistfen | 5 | 20 | Discovery, Story, Mystery |
| Citadel | 0 | 15 | Story, Training, Shops |
| Fire Realm | 0 | 18 | Challenge, Discovery, Boss |
| Ice Realm | 0 | 18 | Challenge, Discovery, Boss |
| Nature Realm | 0 | 18 | Discovery, Story, Boss |
| Void Rift | 0 | 12 | Challenge, Story, Final Boss |
| Shattered Isles | 0 | 10 | Secret, Legendary, Post-game |
| **Total** | 21 | **161** | - |

---

## Secrets & Hidden Content

### Secret Types

#### Hidden Zones
| Secret | Location | Unlock Method | Content |
|--------|----------|---------------|---------|
| Elder's Sanctuary | Evergrove | 100% home row mastery | Bonus lore, special trainer |
| Dwarven Treasury | Stonepass | Find 5 hidden runes | Rare equipment |
| Seer's Vision | Mistfen | Night-time exploration | Prophecy cutscene |
| Ancient Library | Citadel | All punctuation mastered | History of Keystonia |
| Phoenix Roost | Fire Realm | Speed trial under 30s | Phoenix companion |
| Crystal Heart | Ice Realm | Perfect accuracy run | Frost weapon |
| World Seed | Nature Realm | Plant all rare herbs | Garden upgrades |
| Void Echo | Void Rift | Defeat Tyrant flawlessly | True ending unlock |

#### Easter Eggs
- Konami Code location (special room)
- Developer shrine (credits + blooper reel)
- "The Mythical QWERTY" - legendary keyboard relic
- "Dvorak's Revenge" - alternate layout challenge

### Discovery Tracker

```
┌─────────────────────────────────────────────────────────────┐
│ WORLD DISCOVERY                                    78%      │
├─────────────────────────────────────────────────────────────┤
│ Verdant Heartland ████████████████████░░░░ 85%              │
│ Central Kingdom   ████████████████░░░░░░░░ 72%              │
│ Outer Frontier    ████████████░░░░░░░░░░░░ 58%              │
├─────────────────────────────────────────────────────────────┤
│ Secrets Found: 12/25    Lore Pages: 45/80    POIs: 98/161   │
└─────────────────────────────────────────────────────────────┘
```

---

## Journey & Progression Feel

### Travel Narrative

Each region transition includes:
1. **Departure Scene** - Brief farewell from current region
2. **Journey Description** - Text describing the path
3. **Arrival Scene** - Introduction to new region
4. **Local Guide** - NPC explaining region mechanics

Example:
```
╔═══════════════════════════════════════════════════════════════╗
║ JOURNEY TO STONEPASS                                          ║
╟───────────────────────────────────────────────────────────────╢
║                                                               ║
║ The forest thins as the ground rises. Ancient trees give     ║
║ way to stubborn pines clinging to rocky slopes. The air      ║
║ grows thin and cold. Ahead, the Stonepass Mountains pierce   ║
║ the clouds, their peaks crowned with eternal snow.           ║
║                                                               ║
║ Elder Lyra's words echo in your mind:                        ║
║ "The mountains care not for speed alone. Here, precision     ║
║ and endurance will be your allies."                          ║
║                                                               ║
║                    [Continue to Stonepass]                    ║
╚═══════════════════════════════════════════════════════════════╝
```

### Region Identity

Each region has:
- **Unique color palette** for UI theming
- **Distinct music track** (if audio enabled)
- **Regional vocabulary** for word lessons
- **Local NPCs** with region-specific dialogue
- **Signature challenge type** (speed, accuracy, endurance)

---

## Implementation Roadmap

### Phase 1: Foundation (P1)
- [ ] Expand `data/map.json` with region metadata
- [ ] Add region definitions to world structure
- [ ] Create world map UI mockup
- [ ] Implement region unlock system
- [ ] Add 50 new POIs across existing biomes

### Phase 2: Central Kingdom (P1)
- [ ] Add Citadel region with 15+ zones
- [ ] Add Twilight Woods region
- [ ] Add Crystalline Caverns region
- [ ] Expand exploration grid to 32x20
- [ ] Add 40 new POIs

### Phase 3: Outer Frontier (P2)
- [ ] Implement elemental realm expansion
- [ ] Add Void Rift region
- [ ] Create final boss progression
- [ ] Add 50 new POIs
- [ ] Expand exploration grid to 40x24

### Phase 4: Secrets & Polish (P2)
- [ ] Add Shattered Isles post-game zone
- [ ] Implement secret discovery system
- [ ] Add hidden zones and easter eggs
- [ ] Create lore collection system
- [ ] Add world completion tracker

### Phase 5: World Map (P2)
- [ ] Create visual world map UI
- [ ] Implement quick travel system
- [ ] Add journey narrative system
- [ ] Create region transition scenes

---

## Data Schema Additions

### Region Definition

```json
{
  "id": "stonepass",
  "name": "Stonepass Mountains",
  "description": "Ancient peaks where dwarven forges once rang",
  "land": "central_kingdom",
  "biome": "mountain",
  "theme_color": "#7D7D7D",
  "unlock_requirements": {
    "lesson_mastery": ["reach_row_2"],
    "story_day": 8
  },
  "zones": ["stone-gate-pass", "miners-descent", ...],
  "poi_pool": ["poi_stonepass_quarry", "poi_stonepass_watchtower", ...],
  "boss_id": "boss_citadel_warden",
  "signature_challenge": "endurance",
  "grid_size": [8, 5],
  "terrain_weights": {
    "mountain": 0.4,
    "mountain_path": 0.3,
    "cave_entrance": 0.1,
    "forest": 0.1,
    "water": 0.1
  }
}
```

### World Structure

```json
{
  "lands": [
    {
      "id": "verdant_heartland",
      "name": "The Verdant Heartland",
      "regions": ["evergrove", "sunfields", "whisperdale", "millbrook"],
      "day_range": [1, 8],
      "grid_dimensions": [24, 16]
    },
    {
      "id": "central_kingdom",
      "name": "The Central Kingdom",
      "regions": ["stonepass", "mistfen", "citadel", "twilight_woods", "crystalline_caverns"],
      "day_range": [9, 16],
      "grid_dimensions": [32, 20]
    },
    {
      "id": "outer_frontier",
      "name": "The Outer Frontier",
      "regions": ["fire_realm", "ice_realm", "nature_realm", "void_rift", "shattered_isles"],
      "day_range": [17, 30],
      "grid_dimensions": [40, 24]
    }
  ]
}
```

---

## Content Volume Summary

| Category | Current | After Expansion |
|----------|---------|-----------------|
| Lands | 1 (implicit) | 3 |
| Regions | 4 | 14 |
| Biomes | 4 | 12 |
| Map Nodes | 68 | 150+ |
| POIs | 21 | 161+ |
| Boss Encounters | 6 | 12 |
| Hidden Secrets | 0 | 25+ |
| Terrain Types | 4 | 18 |
| Exploration Grid | 16x10 | Up to 40x24 |

---

## References

- `docs/plans/p1/MAP_EXPLORATION_PLAN.md` - Base exploration mechanics
- `data/pois/pois.json` - Current POI definitions
- `data/map.json` - Current map nodes
- `sim/map.gd` - Map generation logic
- `sim/poi.gd` - POI system
- `game/open_world.gd` - Exploration mode
- `data/story.json` - Story and lore integration
