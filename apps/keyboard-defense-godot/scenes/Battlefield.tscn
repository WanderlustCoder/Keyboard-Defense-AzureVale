[gd_scene load_steps=4 format=3 uid="uid://bcuq7gjt3k5ce"]

[ext_resource type="Script" path="res://scripts/Battlefield.gd" id="1"]
[ext_resource type="Script" path="res://scripts/BattleStage.gd" id="2"]
[ext_resource type="Theme" path="res://themes/KeyboardDefenseTheme.tres" id="3"]

[node name="Battlefield" type="Control"]
layout_mode = 3
anchors_preset = 15
anchor_right = 1.0
anchor_bottom = 1.0
grow_horizontal = 2
grow_vertical = 2
theme = ExtResource("3")
script = ExtResource("1")

[node name="Background" type="ColorRect" parent="."]
layout_mode = 0
anchor_right = 1.0
anchor_bottom = 1.0
color = Color(0.06, 0.06, 0.12, 1)

[node name="TopBar" type="HBoxContainer" parent="."]
custom_minimum_size = Vector2(0, 64)
layout_mode = 0
anchor_right = 1.0
offset_left = 16.0
offset_top = 16.0
offset_right = -16.0

[node name="LessonLabel" type="Label" parent="TopBar"]
layout_mode = 2
size_flags_horizontal = 3
text = "Lesson"

[node name="GoldLabel" type="Label" parent="TopBar"]
layout_mode = 2
size_flags_horizontal = 3
text = "Gold: 0"
horizontal_alignment = 2

[node name="PauseButton" type="Button" parent="TopBar"]
layout_mode = 2
text = "Pause"

[node name="ExitButton" type="Button" parent="TopBar"]
layout_mode = 2
text = "Retreat"

[node name="TargetsLabel" type="Label" parent="."]
layout_mode = 0
anchor_left = 0.3
anchor_top = 0.12
anchor_right = 0.7
anchor_bottom = 0.16
theme_override_colors/font_color = Color(0.76, 0.82, 0.94, 1)
text = "Targets: 0/0"
horizontal_alignment = 1

[node name="PlayField" type="PanelContainer" parent="."]
layout_mode = 0
anchor_left = 0.05
anchor_top = 0.18
anchor_right = 0.95
anchor_bottom = 0.52

[node name="FieldSurface" type="ColorRect" parent="PlayField"]
layout_mode = 2
color = Color(0.09, 0.08, 0.16, 1)

[node name="BattleStage" type="Control" parent="PlayField"]
layout_mode = 2
mouse_filter = 2
script = ExtResource("2")

[node name="Castle" type="ColorRect" parent="PlayField/BattleStage"]
layout_mode = 0
offset_right = 80.0
offset_bottom = 70.0
color = Color(0.22, 0.18, 0.26, 1)

[node name="Enemy" type="ColorRect" parent="PlayField/BattleStage"]
layout_mode = 0
offset_right = 60.0
offset_bottom = 44.0
color = Color(0.63, 0.22, 0.26, 1)

[node name="ProjectileLayer" type="Control" parent="PlayField/BattleStage"]
anchors_preset = 0
anchor_right = 1.0
anchor_bottom = 1.0
mouse_filter = 2

[node name="BuffHud" type="PanelContainer" parent="PlayField"]
visible = false
layout_mode = 2

[node name="Content" type="VBoxContainer" parent="PlayField/BuffHud"]
layout_mode = 2
theme_override_constants/separation = 6

[node name="Title" type="Label" parent="PlayField/BuffHud/Content"]
layout_mode = 2
text = "Buffs"
horizontal_alignment = 1

[node name="FocusRow" type="HBoxContainer" parent="PlayField/BuffHud/Content"]
layout_mode = 2
theme_override_constants/separation = 8
alignment = 1

[node name="FocusLabel" type="Label" parent="PlayField/BuffHud/Content/FocusRow"]
layout_mode = 2
size_flags_horizontal = 3
text = "Focus"

[node name="FocusBar" type="ProgressBar" parent="PlayField/BuffHud/Content/FocusRow"]
custom_minimum_size = Vector2(80, 12)
layout_mode = 2
size_flags_horizontal = 3
max_value = 1.0

[node name="WardRow" type="HBoxContainer" parent="PlayField/BuffHud/Content"]
layout_mode = 2
theme_override_constants/separation = 8
alignment = 1

[node name="WardLabel" type="Label" parent="PlayField/BuffHud/Content/WardRow"]
layout_mode = 2
size_flags_horizontal = 3
text = "Ward"

[node name="WardBar" type="ProgressBar" parent="PlayField/BuffHud/Content/WardRow"]
custom_minimum_size = Vector2(80, 12)
layout_mode = 2
size_flags_horizontal = 3
max_value = 1.0

[node name="TypingPanel" type="PanelContainer" parent="."]
layout_mode = 0
anchor_left = 0.05
anchor_top = 0.54
anchor_right = 0.95
anchor_bottom = 0.7

[node name="Content" type="VBoxContainer" parent="TypingPanel"]
layout_mode = 2
theme_override_constants/separation = 6
alignment = 1

[node name="DrillTitle" type="Label" parent="TypingPanel/Content"]
layout_mode = 2
theme_override_colors/font_color = Color(0.96, 0.88, 0.68, 1)
text = "Drill"
horizontal_alignment = 1

[node name="DrillHint" type="Label" parent="TypingPanel/Content"]
layout_mode = 2
theme_override_colors/font_color = Color(0.7, 0.74, 0.86, 1)
text = "Type the runes to defend the castle."
horizontal_alignment = 1
autowrap_mode = 3

[node name="DrillTarget" type="RichTextLabel" parent="TypingPanel/Content"]
layout_mode = 2
theme_override_colors/default_color = Color(0.92, 0.95, 1, 1)
bbcode_enabled = true
fit_content = true
scroll_active = false

[node name="FeedbackLabel" type="Label" parent="TypingPanel/Content"]
visible = false
layout_mode = 2
theme_override_colors/font_color = Color(0.82, 0.9, 0.62, 1)
horizontal_alignment = 1

[node name="TypingReadout" type="VBoxContainer" parent="TypingPanel/Content"]
layout_mode = 2
theme_override_constants/separation = 2
alignment = 1

[node name="WordLabel" type="Label" parent="TypingPanel/Content/TypingReadout"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.94, 1, 1)
text = "Target:"
horizontal_alignment = 1

[node name="TypedLabel" type="Label" parent="TypingPanel/Content/TypingReadout"]
layout_mode = 2
theme_override_colors/font_color = Color(0.9, 0.94, 1, 1)
text = "Typed:"
horizontal_alignment = 1

[node name="StatusPanel" type="PanelContainer" parent="."]
layout_mode = 0
anchor_left = 0.05
anchor_top = 0.72
anchor_right = 0.45
anchor_bottom = 0.94

[node name="Content" type="VBoxContainer" parent="StatusPanel"]
layout_mode = 2

[node name="CastleMarker" type="Label" parent="StatusPanel/Content"]
layout_mode = 2
text = "Castle: Eldenwatch"

[node name="CastleLabel" type="Label" parent="StatusPanel/Content"]
layout_mode = 2
text = "Castle Health: 3"

[node name="AccuracyLabel" type="Label" parent="StatusPanel/Content"]
layout_mode = 2
text = "Accuracy: 100%"

[node name="MistakesLabel" type="Label" parent="StatusPanel/Content"]
layout_mode = 2
text = "Errors: 0"

[node name="WpmLabel" type="Label" parent="StatusPanel/Content"]
layout_mode = 2
text = "WPM: 0"

[node name="ThreatBar" type="ProgressBar" parent="StatusPanel/Content"]
custom_minimum_size = Vector2(0, 12)
layout_mode = 2
size_flags_horizontal = 3

[node name="BonusPanel" type="PanelContainer" parent="."]
layout_mode = 0
anchor_left = 0.55
anchor_top = 0.72
anchor_right = 0.95
anchor_bottom = 0.94

[node name="BonusLabel" type="Label" parent="BonusPanel"]
layout_mode = 2
text = "Bonuses: None"
autowrap_mode = 3

[node name="ResultPanel" type="PanelContainer" parent="."]
visible = false
layout_mode = 0
anchor_left = 0.2
anchor_top = 0.28
anchor_right = 0.8
anchor_bottom = 0.72

[node name="Content" type="VBoxContainer" parent="ResultPanel"]
layout_mode = 2
alignment = 1

[node name="ResultLabel" type="Label" parent="ResultPanel/Content"]
layout_mode = 2
text = "Victory!"
horizontal_alignment = 1

[node name="ResultButton" type="Button" parent="ResultPanel/Content"]
layout_mode = 2
text = "Return"

[node name="PausePanel" type="PanelContainer" parent="."]
visible = false
layout_mode = 0
anchor_left = 0.26
anchor_top = 0.28
anchor_right = 0.74
anchor_bottom = 0.72

[node name="Content" type="VBoxContainer" parent="PausePanel"]
layout_mode = 2
theme_override_constants/separation = 10
alignment = 1

[node name="PauseLabel" type="Label" parent="PausePanel/Content"]
layout_mode = 2
text = "Paused"
horizontal_alignment = 1

[node name="ButtonRow" type="HBoxContainer" parent="PausePanel/Content"]
layout_mode = 2
theme_override_constants/separation = 12
alignment = 1

[node name="ResumeButton" type="Button" parent="PausePanel/Content/ButtonRow"]
layout_mode = 2
text = "Resume"

[node name="RetreatButton" type="Button" parent="PausePanel/Content/ButtonRow"]
layout_mode = 2
text = "Retreat"

[node name="DebugPanel" type="PanelContainer" parent="."]
visible = false
layout_mode = 0
anchor_left = 0.1
anchor_top = 0.12
anchor_right = 0.9
anchor_bottom = 0.88

[node name="Content" type="VBoxContainer" parent="DebugPanel"]
layout_mode = 2
theme_override_constants/separation = 8

[node name="Header" type="Label" parent="DebugPanel/Content"]
layout_mode = 2
text = "Debug Drill Overrides (JSON)"
horizontal_alignment = 1

[node name="OverridesText" type="TextEdit" parent="DebugPanel/Content"]
custom_minimum_size = Vector2(0, 240)
layout_mode = 2
size_flags_horizontal = 3
size_flags_vertical = 3
wrap_mode = 1

[node name="ButtonRow" type="HBoxContainer" parent="DebugPanel/Content"]
layout_mode = 2
theme_override_constants/separation = 10
alignment = 1

[node name="ApplyButton" type="Button" parent="DebugPanel/Content/ButtonRow"]
layout_mode = 2
text = "Apply"

[node name="CopyButton" type="Button" parent="DebugPanel/Content/ButtonRow"]
layout_mode = 2
text = "Copy JSON"

[node name="CloseButton" type="Button" parent="DebugPanel/Content/ButtonRow"]
layout_mode = 2
text = "Close"

[node name="StatusLabel" type="Label" parent="DebugPanel/Content"]
layout_mode = 2
text = "Press Apply to reload drills."
autowrap_mode = 3
